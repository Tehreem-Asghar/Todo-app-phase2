<!-- Sync Impact Report:
Version change: 0.0.0 → 1.0.0
Modified principles: None (initial creation)
Added sections: Core Principles, Key Standards, Constraints, Governance
Removed sections: None
Templates requiring updates:
- .specify/templates/plan-template.md: ✅ updated
- .specify/templates/spec-template.md: ✅ updated
- .specify/templates/tasks-template.md: ✅ updated
- .specify/templates/commands/*.md: ✅ updated
Follow-up TODOs: None
-->
# Phase II Todo Full-Stack Web Application for Hackathon (Spec-Driven Development) Constitution

## Core Principles

### Spec-first development
No feature implemented without a written spec.

### Security by default
All APIs must be authenticated and user-isolated.

### Test-driven iteration
Write failing tests first, implement minimal code to pass, then refactor.

### Fast feedback loops
Prioritize features that can be demoed and tested quickly.

### AI-assisted but human-reviewed development
AI-assisted but human-reviewed development.

## Key Standards

### API Design
- All backend APIs must be RESTful and follow FastAPI conventions
- All backend API routes must be organized inside a dedicated `api` routes folder and exposed only under the `/api/` URL prefix
- All endpoints must be documented with OpenAPI/Swagger docstrings (auto-generated by FastAPI)
- Standard error response format: `{"detail": "message", "error_code": "CODE"}` with appropriate HTTP status codes (400, 401, 403, 404, 500)

### Security Standards
- JWT authentication is mandatory for all protected endpoints
- Passwords must be hashed using bcrypt (min 12 rounds) before storage
- User data isolation: All database queries for user-owned resources MUST filter by `user_id` extracted from JWT token claims
- Input validation: All request bodies must use Pydantic models with explicit field validators
- CORS policy: Whitelist allowed origins explicitly in environment config (no wildcard `*` in production)
- SQL injection prevention: Use SQLModel parameterized queries only (no string concatenation)
- XSS prevention: All user-generated content must be sanitized before rendering in frontend

### Data Layer
- SQLModel must be used for all database interactions
- Neon Serverless PostgreSQL used as the only database
- All models must include `created_at` and `updated_at` timestamp fields
- Foreign key relationships must be explicitly defined in models

### Code Quality
- Environment variables used for secrets and credentials (never hardcoded)
- No inline styles; frontend styling via Tailwind CSS only
- Type safety enforced: TypeScript for frontend, SQLModel/Pydantic for backend
- Max function length: 50 lines (extract helpers if longer)
- All functions must have docstrings describing purpose, params, and return values

## Constraints

- Frontend: Next.js (App Router), TypeScript, Tailwind CSS
- Backend: FastAPI, SQLModel
- Database: Neon Serverless PostgreSQL
- Authentication: Better Auth with JWT
- Architecture: Monorepo with shared specs
- Deployment-ready code (local + production compatible)

## Governance

Constitution supersedes all other practices; Amendments require documentation, approval, migration plan.
All PRs/reviews must verify compliance.
Complexity must be justified.
Use CLAUDE.md for runtime development guidance.

**Version**: 1.1.0 | **Ratified**: 2025-12-31 | **Last Amended**: 2025-12-31

---

## Changelog

### v1.1.0 (2025-12-31)
- **Added**: Security Standards section with concrete requirements (password hashing, input validation, CORS, XSS prevention)
- **Added**: Specific user isolation pattern (filter by `user_id` from JWT)
- **Added**: Standard error response format for API consistency
- **Added**: Code Quality subsection with measurable rules (max function length, docstring requirements)
- **Added**: Data Layer requirements (timestamps, foreign keys)
- **Improved**: Reorganized Key Standards into subsections (API Design, Security, Data Layer, Code Quality)
- **Improved**: Replaced vague principles ("Clarity and maintainability") with actionable ones ("Test-driven iteration", "Fast feedback loops")
